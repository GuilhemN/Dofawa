{% extends 'DofArticlesBundle::layout.html.twig' %}

{% block breadcrumb %}
  <li>Validation de : {{ article.getName() }}</li>
{% endblock %}

{% block body %}
<a href="{{ path('dof_articles_addList', {'page' : '1', 'type' : type }) }}"><span class="glyphicon glyphicon-chevron-left"></span>Retour à la liste</a>
{% if not newArticle %}
  <a target="blank" style="float:right" href="{{ path('dof_articles_view', {'slug' : article.getOriginalArticle().getSlug(), 'type' : type }) }}">Article original<span class="glyphicon glyphicon-chevron-right"></span></a>
{% endif %}
<form method="post">
  <select name="action">
    <option value="valider">Valider</option>
    <option value="supprimer">Supprimer</option>
  </select>
  <input type="submit" class="btn btn-primary text-center" value="Envoyer">
</form>
{% if newArticle %}
  <h2>Nouvelle proposition: ({{ type }})</h2>
  <article itemscope itemtype="http://schema.org/Article">
    <div class="page-header">
      <h1>
        <span itemprop="name">{{ article.getName(locales()) }}</span>
        <small>
          <time itemprop="dateCreated" datetime="{{ article.createdAt | date("Y-m-d") }}">{{ article.createdAt | date("d/m/Y") }}</time>
        </small>
      </h1>
      By <a href="{{ path('dof_profile_userpage', {'slug' : article.owner.slug}) }}">{{ article.owner.username }}</a>
    </div>

    <div class="well well-lg" itemprop="articleBody">
    <h3>Mots clés :</h3>
      {{ article.getKeys() | raw }}
    <h3>Categorie :</h3>
      {{ article.getCategory() | raw }}
    </div>

    <div class="well well-lg" itemprop="articleBody">
      {{ article.getDescription(locales()) | raw }}
    </div>
  </article>
{% else %}
  <h2>Différences avec l'article original: ({{ type }})</h2>
  <article itemscope itemtype="http://schema.org/Article">
    <div class="page-header">
      <h1>
        <span itemprop="name">{{ article.getName(locales()) }}</span>
        <small>
          <time itemprop="dateCreated" datetime="{{ article.createdAt | date("Y-m-d") }}">{{ article.createdAt | date("d/m/Y") }}</time>
        </small>
      </h1>
      By <a href="{{ path('dof_profile_userpage', {'slug' : article.owner.slug}) }}">{{ article.owner.username }}</a> Edité par <a href="{{ path('dof_profile_userpage', {'slug' : article.updater.slug}) }}">{{ article.updater.username }}</a>
    </div>

    <div class="well well-lg" itemprop="articleBody">
    <h3>Mots clés :</h3>
      {{ article.getKeys() | raw }}
    <h3>Categorie :</h3>
      {{ article.getCategory() | raw }}
    </div>

    <div class="well well-lg" itemprop="articleBody">

    {% for key,diff in diffs %}
      {% if  key % 2 != 0 and diff != "---"%}
        {% if diff[:2] == "< " %}
          <h3>Avant:</h3>
          {{ diff[2:] }}<br>
        {% else %}
          <h3>Après:</h3>
          {{ diff[2:] }}<br>
        {% endif %}
      {% endif %}
    {% endfor %}
    </div>
  </article>

{% endif %}

{% endblock %}